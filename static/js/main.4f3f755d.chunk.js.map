{"version":3,"sources":["helpers/storage.js","constants/callStatuses.js","redux/actions.js","redux/calls/actions.js","components/Typogrhaphy.js","constants/socketEvents.js","constants/storageKeys.js","api/socket.js","api/socketHandlers.js","components/CallModal.js","redux/users/actions.js","constants/userStatuses.js","components/UserItem.js","views/ClientsList.js","constants/resolutionOptions.js","helpers/Logger.js","helpers/callUtils.js","helpers/Utils.js","components/VideoCall/VideoControl.js","constants/toastConfig.js","helpers/responseTransformer.js","api/index.js","constants/index.js","constants/videoStatuses.js","components/VideoCall/ViolationToast.js","views/VideoCall.js","components/NameInput.js","constants/validations.js","components/Header.js","App.js","redux/users/reducer.js","redux/calls/reducer.js","redux/reducers.js","helpers/pagination.js","redux/users/saga.js","helpers/immutable.js","helpers/history.js","redux/sockets/saga.js","redux/calls/saga.js","redux/sagas.js","redux/store.js","index.js"],"names":["key","CallStatuses","PENDING","APPROVED","FINISHED","GET_USERS","GET_USERS_SUCCESS","GET_USERS_ERROR","UPDATE_ME","CALL_MODAL_STATUS","SET_CALL","GET_TWILLIO_CONFIG","GET_TWILLIO_CONFIG_SUCCESS","GET_TWILLIO_CONFIG_FAIL","setModal","payload","type","setCall","getTwilioConfigFail","Title","styled","AntTitle","Paragraph","AntParagraph","SocketEvents","StorageKeys","readUserStorage","JSON","parse","localStorage","getItem","setToUserStorage","data","setItem","stringify","addToStorage","SocketServiceSingleton","config","path","process","transports","name","query","this","socket","io","event","emit","initConnection","createUsersChannel","eventChannel","emitter","eventHandler","onAny","offAny","cancelCall","id","SocketService","sendIceCandidate","sendRTCAnswer","messageToDisplay","isInitiator","caller","status","connect","user","users","me","call","calls","footer","visible","closable","maskClosable","destroyOnClose","onClick","getUsers","getUsersSuccess","UserStatuses","getIconForStatus","ClockCircleTwoTone","PhoneTwoTone","ListItem","AntItem","disabled","calleeId","pagination","isLoading","userList","useMemo","filter","initialLoad","pageStart","loadMore","hasMore","totalCount","length","useWindow","dataSource","renderItem","Resolutions","unlimited","highest","normal","minecraft","resolutionsValues","width","ideal","height","resolutionOptions","Object","values","LogEvents","label","style","logger","console","log","Date","toISOString","logRTC","logApi","handleNegotiationNeededEvent","opponentSocketId","peerConnection","createOffer","then","offer","setLocalDescription","target","sdp","localDescription","catch","handleBlockUnload","window","onbeforeunload","getPreviewFromVideo","video","Promise","resolve","canvas","document","createElement","onloadeddata","videoWidth","videoHeight","getContext","drawImage","dataURL","toDataURL","Bar","div","VideoControl","toggleMinify","toggleMute","setResolution","handleHangup","resolution","isMinified","isMuted","FullscreenOutlined","FullscreenExitOutlined","SoundOutlined","AudioMutedOutlined","ExportOutlined","value","onChange","map","option","Option","toastConfig","position","autoClose","hideProgressBar","closeOnClick","pauseOnHover","draggable","progress","undefined","responseTransformer","response","withToast","error","toast","message","BASE_URL","getUserList","limit","offset","axios","get","params","getTwilioConfig","checkImageViolation","file","post","isSafe","Error","VideoStatuses","ViolationToast","closeToast","acceptVideo","Container","Video","props","history","socketRef","useRef","opponentId","callee","find","socketId","localStream","localVideo","remoteVideo","useState","connection","navigator","mozConnection","webkitConnection","saveData","effectiveType","includes","getVideoOptions","setIsMinified","setIsMuted","videoStatus","setVideoStatus","audio","streamConstraints","handleCallCleanup","current","close","closePeerConnection","getTracks","forEach","track","stop","handleTrackEvent","a","streams","srcObject","warning","createPeerConnection","peer","RTCPeerConnection","onicecandidate","e","candidate","handleICECandidateEvent","ontrack","onnegotiationneeded","addTrack","handleRecieveCall","incoming","setRemoteDescription","RTCSessionDescription","createAnswer","answer","useEffect","replace","socketListeners","blockUnloadCleanup","events","mediaDevices","getUserMedia","stream","callerId","callUser","push","handleAnswer","RTCIceCandidate","addIceCandidate","handleNewICECandidateMsg","once","on","listener","i","off","getVideoTracks","applyConstraints","audioTracks","getAudioTracks","currentState","enabled","ref","autoPlay","fullHeight","muted","NameInput","useSelector","state","editingName","setEditingName","isEditing","setIsEditing","editable","onEnd","newName","onCancel","onStart","editing","maxLength","Header","AntHeader","PageHeader","modalOpen","exact","component","ClientsList","VideoCall","INIT_STATE","reducers","combineReducers","updatePaginationState","nextOffset","watchGetUsers","rootSaga","takeEvery","getUsersAsync","select","put","all","fork","immutableSplice","list","index","slice","createBrowserHistory","watchSocketsChannel","channel","take","declinedCall","CANCELED","reactHistory","ongoingCall","findIndex","watchGetTwilioConfig","getConfig","takeLatest","servers","getState","usersSagas","callsSagas","socketsSagas","sagaMiddleware","createSagaMiddleware","middlewares","configureStore","initialState","enhancedCompose","compose","__REDUX_DEVTOOLS_EXTENSION_COMPOSE__","store","createStore","applyMiddleware","run","sagas","ReactDOM","render","fallback","className","routerHistory","getElementById"],"mappings":"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","file":"static/js/main.4f3f755d.chunk.js","sourcesContent":["import { StorageKeys } from '../constants/storageKeys';\n\nexport const addToStorage = key => data => localStorage.setItem(key, JSON.stringify(data));\nexport const readFromStorage = key => () => JSON.parse(localStorage.getItem(key) || null);\n\nexport const readUserStorage = readFromStorage(StorageKeys.USER);\nexport const setToUserStorage = addToStorage(StorageKeys.USER);\n","/**\n * @enum\n */\nexport const CallStatuses = {\n  PENDING: 1,\n  APPROVED: 2,\n  FINISHED: 3,\n};\n","/* USERS */\nexport const GET_USERS = 'GET_USERS';\nexport const GET_USERS_SUCCESS = 'GET_USERS_SUCCESS';\nexport const GET_USERS_ERROR = 'GET_USERS_ERROR';\nexport const UPDATE_ME = 'UPDATE_ME';\nexport const UPDATE_ME_SUCCESS = 'UPDATE_ME_SUCCESS';\nexport const UPDATE_ME_ERROR = 'UPDATE_ME_ERROR';\n\n/* CALLS */\nexport const CALL_MODAL_STATUS = 'CALL_MODAL_STATUS';\nexport const SET_CALL = 'SET_CALL';\n\n/* TWILIO */\nexport const GET_TWILLIO_CONFIG = 'SET_TWILLIO_CONFIG';\nexport const GET_TWILLIO_CONFIG_SUCCESS = 'SET_TWILLIO_CONFIG_SUCCESS';\nexport const GET_TWILLIO_CONFIG_FAIL = 'SET_TWILLIO_CONFIG_FAIL';\n","import {\n  CALL_MODAL_STATUS, GET_TWILLIO_CONFIG, GET_TWILLIO_CONFIG_FAIL, GET_TWILLIO_CONFIG_SUCCESS, SET_CALL,\n} from \"../actions\";\n\nexport const setModal = payload => ({\n  type: CALL_MODAL_STATUS,\n  payload\n})\n\nexport const setCall = payload => ({\n  type: SET_CALL,\n  payload\n})\n\nexport const getTwilioConfig = payload => ({\n  type: GET_TWILLIO_CONFIG,\n  payload\n})\n\nexport const getTwilioConfigSuccess = payload => ({\n  type: GET_TWILLIO_CONFIG_SUCCESS,\n  payload\n})\n\nexport const getTwilioConfigFail = payload => ({\n  type: GET_TWILLIO_CONFIG_FAIL,\n  payload\n})\n","import styled from 'styled-components'\n\nimport AntTitle from 'antd/lib/typography/Title'\nimport AntParagraph from 'antd/lib/typography/Paragraph'\nimport 'antd/lib/typography/style/css';\n\nconst Title = styled(AntTitle)`\n    margin-top: 0;\n    font-size: clamp(1rem, 10vw, 3.5rem);\n    line-height: 1.2;\n`\n\nconst Paragraph = styled(AntParagraph)`\n    margin-bottom: 0 !important;\n`;\n\nexport {\n  Title,\n  Paragraph,\n};\n","/**\n * @enum\n */\nexport const SocketEvents = {\n  USER_JOINED: 'USER_JOINED',\n  USER_LEFT: 'USER_LEFT',\n  MY_DATA: 'MY_DATA',\n  USER_UPDATED: 'USER_UPDATED',\n  /* CALLS */\n  REQUESTED_CALL: 'REQUESTED_CALL',\n  ACCEPTED_CALL: 'ACCEPTED_CALL',\n  DECLINED_CALL: 'DECLINED_CALL',\n  /* RTC */\n  OFFER: 'OFFER',\n  ANSWER: 'ANSWER',\n  ICE_CANDIDATE: 'ICE_CANDIDATE',\n  /* ERRORS */\n  CUSTOM_ERROR: 'CUSTOM_ERROR',\n};\n","\nexport const StorageKeys = {\n  USER: 'vc-user',\n}\n","import { io } from \"socket.io-client\";\nimport { eventChannel } from 'redux-saga';\n\nimport { readUserStorage } from '../helpers/storage';\n\n\n\nclass SocketService {\n  initConnection() {\n    const config = {\n      path: process.env.REACT_APP_SOCKET_PATH,\n      transports: [\"websocket\"],\n    }\n\n    const name = readUserStorage();\n    if(name) config.query = { name };\n\n    this.socket = io(process.env.REACT_APP_SOCKET_URL, config)\n  }\n\n  emit(event, data) {\n    this.socket.emit(event, data);\n  }\n}\n\nconst SocketServiceSingleton = new SocketService();\nSocketServiceSingleton.initConnection();\n\nexport const createUsersChannel = () => {\n  const socket = SocketServiceSingleton.socket;\n\n  const subscribe = emitter => {\n    const eventHandler = (event, data) => emitter({ event, data });\n\n    socket.onAny(eventHandler);\n\n    return () => socket.offAny(eventHandler);\n  };\n\n  return eventChannel(subscribe);\n}\n\nexport default SocketServiceSingleton;\n","import { SocketEvents } from '../constants/socketEvents';\nimport SocketService from './socket';\n\nexport const requestCall = calleeId => SocketService.emit(SocketEvents.REQUESTED_CALL, { calleeId });\nexport const cancelCall = id => SocketService.emit(SocketEvents.DECLINED_CALL, { id });\nexport const acceptCall = id => SocketService.emit(SocketEvents.ACCEPTED_CALL, { id });\n\nexport const sendIceCandidate = payload => SocketService.emit(SocketEvents.ICE_CANDIDATE, payload);\nexport const sendRTCOffer = payload => SocketService.emit(SocketEvents.OFFER, payload);\nexport const sendRTCAnswer = payload => SocketService.emit(SocketEvents.ANSWER, payload);\n\nexport const updateMe = payload => SocketService.emit(SocketEvents.USER_UPDATED, payload);\n","import React from 'react';\nimport { connect } from 'react-redux';\nimport { Button, Modal } from 'antd';\n\nimport { CallStatuses } from '../constants/callStatuses';\nimport { setModal, setCall } from '../redux/calls/actions';\nimport { Title } from './Typogrhaphy'\nimport { cancelCall, acceptCall } from '../api/socketHandlers';\n\nimport 'antd/lib/modal/style/css';\n\nconst messageToDisplay = (isInitiator, { caller, status }) => {\n  if (isInitiator && status === CallStatuses.PENDING) {\n    return 'Your invitation is pending';\n  }\n  if (!isInitiator && status === CallStatuses.PENDING) {\n    return `You've been invited to chat by ${caller?.name || 'Anonymus'}`;\n  }\n\n  return 'Call has been finished';\n}\n\nconst CallModal = ({\n  user,\n  call,\n  setCall,\n  setModal\n}) => {\n  const isInitiator = user.id === call?.caller?.id;\n\n  const declineCall = () => {\n    cancelCall(call.id);\n    setCall(null);\n    setModal(false);\n\n  }\n\n  if(!call?.id || !call?.status) return null;\n\n  return (\n    <Modal\n      footer={null}\n      visible\n      closable={false}\n      maskClosable={false}\n      destroyOnClose={true}\n    >\n      <Title>\n        {messageToDisplay(isInitiator, call)}\n      </Title>\n      {call.status === CallStatuses.PENDING && (\n        <>\n          {!isInitiator && <Button onClick={() => acceptCall(call.id)}>Accept</Button>}\n          <Button onClick={declineCall}>Cancel</Button>\n        </>\n      )}\n    </Modal>\n  )\n}\n\nconst mapStateToProps = ({ users: { me: user }, calls: { call } }) => ({\n  user,\n  call,\n});\n\nexport default connect(mapStateToProps, { setModal, setCall })(CallModal);\n","import {\n  GET_USERS,\n  GET_USERS_SUCCESS,\n  GET_USERS_ERROR,\n  UPDATE_ME,\n  UPDATE_ME_SUCCESS,\n  UPDATE_ME_ERROR,\n} from \"../actions\";\n\nexport const getUsers = payload => {\n  return (\n    {\n      type: GET_USERS,\n      payload\n    }\n  )\n}\n\nexport const getUsersSuccess = payload => {\n  return (\n    {\n      type: GET_USERS_SUCCESS,\n      payload,\n    }\n  )\n}\n\nexport const getUsersError = () => {\n  return (\n    {\n      type: GET_USERS_ERROR,\n    }\n  )\n}\n\nexport const updateMe = payload => {\n  return (\n    {\n      type: UPDATE_ME,\n      payload\n    }\n  )\n}\n\nexport const updateMeSuccess = payload => {\n  return (\n    {\n      type: UPDATE_ME_SUCCESS,\n      payload\n    }\n  )\n}\n\nexport const updateMeUsersError = () => {\n  return (\n    {\n      type: UPDATE_ME_ERROR,\n    }\n  )\n}\n","/**\n * @enum\n */\nexport const UserStatuses = {\n  AVAILABLE: 1,\n  PENDING: 2,\n  ON_CALL: 3,\n};\n","import React from 'react';\nimport { connect } from 'react-redux';\nimport styled from 'styled-components';\n\nimport AntItem from 'antd/lib/list/Item';\nimport Button from 'antd/lib/button';\nimport {\n  PhoneTwoTone,\n  ClockCircleTwoTone,\n} from '@ant-design/icons';\n\nimport { UserStatuses } from '../constants/userStatuses';\nimport { setModal } from '../redux/calls/actions';\nimport { requestCall } from '../api/socketHandlers';\n\nconst getIconForStatus = {\n  [UserStatuses.AVAILABLE]: null,\n  [UserStatuses.PENDING]: < ClockCircleTwoTone />,\n  [UserStatuses.ON_CALL]: <PhoneTwoTone />,\n}\n\nconst ListItem = styled(AntItem)`\n  padding: .5rem 2rem;\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  box-shadow: 0 .6rem 1.2rem 0 rgba(68, 79, 84, 0.05);\n  background: white;\n`;\n\nconst UserItem = ({ user: { id, name, status }, setModal }) => {\n  const handleClick = () => {\n    if(status === UserStatuses.AVAILABLE) {\n      requestCall(id);\n      setModal(true);\n    }\n  }\n  return (\n    <ListItem>\n      <div>\n        {name} {getIconForStatus[status]}\n      </div>\n      <Button disabled={status !== UserStatuses.AVAILABLE} onClick={handleClick}>Invite</Button>\n    </ListItem>\n  )\n};\n\nexport default connect(null, { setModal })(UserItem);\n","import React, { useMemo } from 'react';\nimport { connect } from 'react-redux';\nimport InfiniteScroll from 'react-infinite-scroller';\nimport { List, Spin } from 'antd';\n\nimport { getUsers } from '../redux/users/actions';\nimport UserItem from '../components/UserItem';\n\nconst ClientsList = ({ me, users, pagination, isLoading, getUsers }) => {\n  // eslint-disable-next-line\n  const userList = useMemo(() => users.filter(user => user.id !== me?.id), [users]);\n\n  return (\n    <InfiniteScroll\n      initialLoad={false}\n      pageStart={0}\n      loadMore={getUsers}\n      hasMore={pagination.totalCount < users.length}\n      useWindow={false}\n    >\n      <List\n        dataSource={userList}\n        renderItem={user => <UserItem user={user} key={user.id} />}\n      >\n        {isLoading && (\n          <Spin />\n        )}\n      </List>\n    </InfiniteScroll>\n  )\n}\n\nconst mapStateToProps = ({ users: { users, pagination, isLoading, me } }) => ({\n  users,\n  pagination,\n  isLoading,\n  me,\n})\n\nexport default connect(mapStateToProps, { getUsers })(ClientsList);\n","/**\n * @enum\n */\nexport const Resolutions = {\n  unlimited: 'Unlimited',\n  highest: '1080p',\n  normal: '720p',\n  minecraft: 'Minecraft'\n}\n\nexport const resolutionsValues = {\n  [Resolutions.unlimited]: { width: { ideal: 4096 }, height: { ideal: 2160 } },\n  [Resolutions.highest]: { width: 1920, height: 1080 },\n  [Resolutions.normal]: { width: 1280, height: 720 },\n  [Resolutions.minecraft]: { width: 50, height: 25 },\n}\n\nexport const resolutionOptions = Object.values(Resolutions);\n","const LogEvents = {\n  WEB_RTC: {\n    label: 'WEB_RTC',\n    style: 'color: red;'\n  },\n  SOCKET: {\n    label: 'SOCKET',\n    style: 'color: green;',\n  },\n  API: {\n    label: 'API',\n    style: 'color: blue; background: white;',\n  },\n  DEBUG: {\n    label: 'DEBUG',\n  },\n}\n\nexport const logger = ({ label, style }) => payload => console.log(`%c\n  ${label} at ${new Date().toISOString()}:\n  ${JSON.stringify(payload)}\n`, style);\n\nexport const logRTC = logger(LogEvents.WEB_RTC)\nexport const logSocket = logger(LogEvents.SOCKET)\nexport const logApi = logger(LogEvents.API)\nexport const logDebug = logger(LogEvents.DEBUG)\n","import SocketService from '../api/socket';\nimport { sendIceCandidate, sendRTCOffer } from '../api/socketHandlers'\nimport { Resolutions } from '../constants/resolutionOptions';\nimport { logRTC } from './Logger';\n\n/**\n * Handle ICE candidate in case if any available candidates left\n * to try and establish connection\n * @param {any} event.candidate Candidate object\n * @param {string} opponentId Socket id of opponent\n * @returns {void}\n */\nexport function handleICECandidateEvent({ candidate } = {}, opponentId) {\n  if (candidate) {\n    sendIceCandidate({\n      target: opponentId,\n      candidate: candidate,\n    })\n  }\n}\n\n/**\n * Handle Ice candidate event incoming from socket\n * @param {any} event Socket event payload\n * @param {{current: RTCPeerConnection}} peerConnection Ref to Peer connection\n */\nexport function handleNewICECandidateMsg(event, peerConnection) {\n  try {\n    const candidate = new RTCIceCandidate(event);\n\n    peerConnection.current\n      .addIceCandidate(candidate)\n      .catch(logRTC);\n  } catch {\n    logRTC('candidate error');\n  }\n\n}\n\n/**\n * Start handshacke procedure by creating an offer\n * @param {string} opponentSocketId\n * @param {RTCPeerConnection} peerConnection Peer connection stored in ref\n * @returns {void}\n */\nexport const handleNegotiationNeededEvent = (opponentSocketId, peerConnection) => {\n  peerConnection\n    .createOffer()\n    .then(offer => peerConnection.setLocalDescription(offer))\n    .then(() => sendRTCOffer({\n      target: opponentSocketId,\n      caller: SocketService.socket.id,\n      sdp: peerConnection.localDescription\n    }))\n    .catch(logRTC);\n}\n\n/**\n * Handle answer socket event\n * @param {object} event\n * @param {object} event.sdp Session descriptor sent by socket\n * @param {{current: RTCPeerConnection}} peerConnection Ref to Peer connection\n * @returns {void}\n */\nexport const handleAnswer = (event, peerConnection) => {\n  peerConnection.current\n    .setRemoteDescription(new RTCSessionDescription(event.sdp))\n    .catch(logRTC);\n}\n\n\nexport const getVideoOptions = () => {\n  const connection = navigator.connection || navigator.mozConnection || navigator.webkitConnection;\n\n  if(connection?.saveData || connection?.effectiveType?.includes('2g')) return Resolutions.minecraft;\n  if(connection?.effectiveType === '3g') return Resolutions.normal;\n\n  return Resolutions.unlimited;\n}\n","/**\n * Handle warning before closing window,\n * defauld message will be displayed\n * @returns {Function} Cleanup function\n */\nexport const handleBlockUnload = () => {\n  window.onbeforeunload = () => 'Are you sure you want to leave?';\n\n  return () => window.onbeforeunload = null;\n}\n\nexport const getPreviewFromVideo = (video) => {\n  return new Promise(resolve => {\n    const canvas = document.createElement('canvas');\n    video.onloadeddata = () => {\n      console.log(video.videoWidth)\n\n      canvas.width = video.videoWidth;\n      canvas.height = video.videoHeight;\n\n      canvas\n        .getContext('2d')\n        .drawImage(video, 0, 0, canvas.width, canvas.height);\n\n      const dataURL = canvas.toDataURL();\n\n      resolve(dataURL)\n    }\n  })\n}\n","import React from 'react'\n\nimport {\n  FullscreenExitOutlined,\n  FullscreenOutlined,\n  AudioMutedOutlined,\n  SoundOutlined,\n  ExportOutlined,\n} from '@ant-design/icons';\nimport { Select } from 'antd';\nimport styled from 'styled-components';\nimport 'antd/lib/select/style/css';\n\nimport { resolutionOptions } from '../../constants/resolutionOptions';\n\n\n\nconst Bar = styled.div`\n  position: absolute;\n  width: 100%;\n  height: 3rem;\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n  z-index: 1;\n  background: var(--grayish);\n  padding: 0 1rem;\n\n  svg {\n    margin-right: 1rem;\n\n    path {\n      fill: var(--dark);\n    }\n  }\n`\n\nconst VideoControl = ({\n  toggleMinify,\n  toggleMute,\n  setResolution,\n  handleHangup,\n  resolution,\n  isMinified,\n  isMuted,\n}) => {\n  return (\n    <Bar>\n      <div>\n        {isMinified\n          ? <FullscreenOutlined onClick={toggleMinify} />\n          : <FullscreenExitOutlined onClick={toggleMinify} />\n        }\n        {isMuted\n          ? <SoundOutlined onClick={toggleMute} />\n          : <AudioMutedOutlined onClick={toggleMute} />\n        }\n        <ExportOutlined onClick={handleHangup} />\n      </div>\n\n      <div>\n        <Select value={resolution} onChange={setResolution}>\n        {resolutionOptions.map(option => (\n          <Select.Option value={option} key={`resolution-${option}`}>\n            {option}\n          </Select.Option>\n        ))}\n      </Select>\n      </div>\n    </Bar>\n  )\n}\n\nexport default VideoControl\n","export const toastConfig = {\n  position: \"top-right\",\n  autoClose: 5000,\n  hideProgressBar: false,\n  closeOnClick: true,\n  pauseOnHover: false,\n  draggable: false,\n  progress: undefined,\n};\n","import { toast } from 'react-toastify';\n\nimport { toastConfig } from '../constants/toastConfig';\nimport { logApi } from './Logger';\n\n/**\n * Transform API response\n * @param {AxiosResponse} response\n * @param {Object} config\n * @param {boolean} [config.withToast=false] Indicates if error should be displayed in toast\n * @returns {any}\n */\nexport const responseTransformer = (\n  response,\n  {\n    withToast = false\n  } = {}\n) => response\n  .then(({ data }) => data)\n  .catch(error => {\n    logApi(error);\n\n    if (withToast) {\n      toast.error(error.message, toastConfig);\n    }\n  });\n","import axios from \"axios\";\n\nimport { DEFAULT_LIMIT, DEFAULT_OFFSET } from \"../constants\";\nimport { responseTransformer } from '../helpers/responseTransformer';\n\nconst BASE_URL = `${process.env.REACT_APP_BASE_URL}/${process.env.REACT_APP_API_VERSION}`;\n\nexport const getUserList = (\n  {\n    limit = DEFAULT_LIMIT,\n    offset = DEFAULT_OFFSET\n  } = {}\n) => responseTransformer(\n  axios.get(`${BASE_URL}/users`, { params: { limit, offset } })\n);\n\nexport const getTwilioConfig = () => responseTransformer(\n  axios.get(`${BASE_URL}/twilio/config`),\n  { withToast: true }\n);\n\n/**\n * @param {string} file Base64 encoded image\n * @returns {boolen} Indicates if image is safe\n*/\nexport const checkImageViolation = file => responseTransformer(\n    axios.post(process.env.REACT_APP_VIOLATION_API, { file })\n  )\n  .then(({ isSafe }) => {\n    if(!isSafe) throw new Error();\n  })\n\n","export const DEFAULT_LIMIT = 20;\nexport const MIN_LIMIT = 0;\nexport const MAX_LIMIT = 100;\nexport const DEFAULT_OFFSET = 0;\n","/**\n * @enum\n */\nexport const VideoStatuses = {\n  pending: 1,\n  safe: 2,\n  unsafe: 3.\n}\n","import { Button } from 'antd'\nimport React from 'react'\n\nconst ViolationToast = ({ closeToast, acceptVideo }) => {\n  return (\n    <div>\n      <div>\n        Cup alert!\n      </div>\n      <Button\n        onClick={() => {\n          acceptVideo();\n          closeToast();\n        }}\n      >\n        Show anyway\n      </Button>\n    </div>\n  )\n}\n\nexport default ViolationToast\n","import React, { useEffect, useRef, useState } from 'react';\nimport { connect } from 'react-redux';\nimport { toast } from 'react-toastify';\nimport styled from 'styled-components';\n\nimport { setCall } from '../redux/calls/actions';\nimport SocketService from '../api/socket';\nimport {\n  getVideoOptions,\n  handleAnswer,\n  handleICECandidateEvent,\n  handleNegotiationNeededEvent,\n  handleNewICECandidateMsg\n} from '../helpers/callUtils';\nimport { SocketEvents } from '../constants/socketEvents';\nimport { cancelCall, sendRTCAnswer } from '../api/socketHandlers';\nimport { getPreviewFromVideo, handleBlockUnload } from '../helpers/Utils';\nimport { resolutionsValues } from '../constants/resolutionOptions';\nimport VideoControl from '../components/VideoCall/VideoControl';\nimport { checkImageViolation } from '../api';\nimport { toastConfig } from '../constants/toastConfig';\nimport { VideoStatuses } from '../constants/videoStatuses';\nimport ViolationToast from '../components/VideoCall/ViolationToast';\n\nconst Container = styled.div`\n  position: relative;\n`\n\nconst absoluteStyles = `\n  top: 3rem;\n  left: 0;\n  position: absolute;\n`\n\nconst Video = styled.video`\n  width: ${props => props.isMinified ? '250px' : '100%'};\n  object-fit: cover;\n  height: ${props => props.isMinified\n      ? '100px'\n      : '100%'\n  };\n  ${props => props.isMinified ? absoluteStyles : ''}\n  filter: ${props => props.status !== VideoStatuses.safe ? 'blur(30px)' : 'none'};\n`;\n\nconst OngoingCall = ({ call, user, setCall, config, history }) => {\n  const socketRef = useRef(SocketService.socket);\n\n  const opponentId = useRef([call?.caller, call?.callee].find(({ id } = {}) => id !== user?.id)?.socketId);\n\n  const peerConnection = useRef();\n  const localStream = useRef();\n  const localVideo = useRef();\n  const remoteVideo = useRef();\n\n  const [resolution, setResolution] = useState(getVideoOptions())\n  const [isMinified, setIsMinified] = useState(true);\n  const [isMuted, setIsMuted] = useState(false)\n  const [videoStatus, setVideoStatus] = useState(VideoStatuses.pending)\n\n  const [streamConstraints] = useState({\n    audio: true,\n    video: resolutionsValues[resolution]\n  });\n\n  const closePeerConnection = () => {\n    console.log(peerConnection)\n    peerConnection.current?.close()\n    peerConnection.current = undefined;\n  }\n\n  const handleCallCleanup = () => {\n    closePeerConnection();\n    if (localStream.current) {\n      localStream.current\n        .getTracks()\n        .forEach(track => track.stop());\n    }\n  }\n\n  const handleTrackEvent = async ({ streams }) => {\n    remoteVideo.current.srcObject = streams[0];\n\n    getPreviewFromVideo(remoteVideo.current)\n      .then(checkImageViolation)\n      .then(() => setVideoStatus(VideoStatuses.safe))\n      .catch(() => {\n        setVideoStatus(VideoStatuses.unsafe)\n\n        toast.warning(\n          <ViolationToast acceptVideo={() => setVideoStatus(VideoStatuses.safe)} />,\n          {...toastConfig, autoClose: false }\n        );\n      })\n  }\n\n  function createPeerConnection(opponentSocketId) {\n    const peer = new RTCPeerConnection(config);\n\n    peer.onicecandidate = (e) => handleICECandidateEvent(e, opponentId.current);\n    peer.ontrack = handleTrackEvent;\n    peer.onnegotiationneeded = () => handleNegotiationNeededEvent(opponentSocketId, peer);\n\n    return peer;\n  }\n\n  async function callUser(opponentSocketId) {\n    peerConnection.current = createPeerConnection(opponentSocketId);\n\n    localStream.current\n      .getTracks()\n      .forEach(track => peerConnection.current.addTrack(track, localStream.current));\n  }\n\n  async function handleRecieveCall(incoming) {\n    peerConnection.current = createPeerConnection();\n\n    peerConnection.current.setRemoteDescription(new RTCSessionDescription(incoming.sdp))\n      .then(() => localStream.current\n        .getTracks()\n        .forEach(track => peerConnection.current.addTrack(track, localStream.current))\n      )\n      .then(() => peerConnection.current.createAnswer())\n      .then(answer => {\n        peerConnection.current.setLocalDescription(answer)\n        return answer;\n      })\n      .then(answer => {\n        sendRTCAnswer({\n          target: incoming.caller,\n          caller: socketRef.current.id,\n          sdp: answer\n        })\n      })\n  }\n\n  const handleHangup = () => {\n    cancelCall(call.id);\n    setCall(null);\n    handleBlockUnload()();\n    history.replace('/')\n  }\n\n  const handleMute = () => {\n    const audioTracks = localStream.current.getAudioTracks();\n    const currentState = audioTracks[0].enabled;\n\n    setIsMuted(!currentState);\n    audioTracks[0].enabled = !currentState;\n  }\n\n  const handleMinify = () => setIsMinified(current => !current);\n\n  const updateResolution = (key) => {\n    const videoTracks = localStream.current.getVideoTracks();\n    videoTracks.forEach(track => {\n      setResolution(() => key);\n      track.applyConstraints(resolutionsValues[key])\n    })\n  }\n\n  useEffect(() => {\n    if (!call?.id) {\n      history.replace('/')\n      return false;\n    }\n\n    const socketListeners = []\n\n    const blockUnloadCleanup = handleBlockUnload();\n\n    const events = [\n      SocketEvents.OFFER,\n      SocketEvents.ANSWER,\n      SocketEvents.ICE_CANDIDATE,\n    ]\n\n    navigator.mediaDevices\n      .getUserMedia(streamConstraints)\n      .then(stream => {\n        localVideo.current.srcObject = stream;\n        localStream.current = stream;\n\n\n        if (user.id === call?.callerId) {\n          callUser(call.callee.socketId);\n        }\n\n        socketListeners.push(\n          handleRecieveCall,\n          e => handleAnswer(e, peerConnection),\n          e => handleNewICECandidateMsg(e, peerConnection)\n        )\n\n        socketRef.current.once(SocketEvents.OFFER, socketListeners[0]);\n        socketRef.current.once(SocketEvents.ANSWER, socketListeners[1]);\n        socketRef.current.on(SocketEvents.ICE_CANDIDATE, socketListeners[2]);\n      });\n\n    return () => {\n      blockUnloadCleanup();\n      handleCallCleanup();\n      peerConnection.current = undefined;\n\n      socketListeners.forEach((listener, i) => SocketService.socket.off(events[i], listener))\n    }\n    // eslint-disable-next-line\n  }, []);\n\n  return (\n    <Container>\n      <div>\n        <VideoControl\n          setResolution={updateResolution}\n          toggleMinify={handleMinify}\n          toggleMute={handleMute}\n          handleHangup={handleHangup}\n          isMinified={isMinified}\n          isMuted={isMuted}\n          resolution={resolution}\n        />\n\n        <Video\n          ref={remoteVideo}\n          autoPlay\n          fullHeight={isMinified}\n          status={videoStatus}\n        />\n\n        <Video\n          ref={localVideo}\n          muted\n          autoPlay\n          isMinified={isMinified}\n          status={VideoStatuses.safe}\n        />\n      </div>\n    </Container>\n  )\n}\n\nconst mapStateToProps = ({ users: { me: user }, calls: { call, config } }) => ({\n  user,\n  call,\n  config\n})\nexport default connect(mapStateToProps, { setCall })(OngoingCall);\n\n","import { useEffect, useState } from 'react'\nimport { useSelector } from 'react-redux';\n\nimport { updateMe } from '../api/socketHandlers';\nimport { Paragraph } from './Typogrhaphy'\nimport { NAME_MAX_LENGTH } from '../constants/validations'\n\nconst NameInput = () => {\n  const user = useSelector(state => state.users.me);\n  const [editingName, setEditingName] = useState();\n  const [isEditing, setIsEditing] = useState();\n\n  const handleUpdate = () => setEditingName(newName => {\n    updateMe({ name: newName });\n    setIsEditing(() => false);\n    return newName\n  })\n\n  useEffect(() => {\n    if(user?.name !== editingName) {\n      setEditingName(user.name)\n    }\n\n    // eslint-disable-next-line\n  }, [user])\n\n  return (\n    <Paragraph\n      editable={{\n        onChange: setEditingName,\n        onEnd: handleUpdate,\n        onCancel: () => {\n          setEditingName(() => user.name);\n          setIsEditing(() => false);\n        },\n        onStart: () => setIsEditing(true),\n        editing: isEditing,\n        maxLength: NAME_MAX_LENGTH,\n      }}\n    >\n      {editingName}\n    </Paragraph>\n\n  )\n}\n\nexport default NameInput;\n","export const NAME_MAX_LENGTH = 50;\n","\nimport { Header as AntHeader } from 'antd/lib/layout/layout';\nimport styled from 'styled-components';\n\nimport NameInput from './NameInput';\n\nconst Header = styled(AntHeader)`\n  padding: 2rem;\n  background: var(--whitey);\n\n  svg {\n    fill: var(--dark);\n  }\n`;\n\nconst PageHeader = () => {\n  return (\n    <Header>\n      <NameInput />\n    </Header>\n  );\n}\n\nexport default PageHeader;\n","import { React, useEffect } from 'react';\nimport { connect } from 'react-redux';\nimport { Route, Switch } from 'react-router-dom';\nimport Layout from 'antd/lib/layout/layout';\n\nimport CallModal from './components/CallModal';\nimport { getUsers } from './redux/users/actions';\nimport { getTwilioConfig } from './redux/calls/actions';\nimport ClientsList from './views/ClientsList';\nimport VideoCall from './views/VideoCall';\nimport Header from './components/Header';\n\nconst App = ({\n  getUsers,\n  modalOpen,\n  getTwilioConfig,\n}) => {\n  useEffect(() => {\n    getTwilioConfig()\n    getUsers();\n  }, [getUsers, getTwilioConfig])\n\n  return (\n    <Layout>\n    <Header />\n    <main>\n        <Switch>\n          <Route exact path=\"/\" component={ClientsList} />\n          <Route exact path=\"/call\" component={VideoCall} />\n        </Switch>\n      {modalOpen && <CallModal />}\n    </main>\n    </Layout>\n  );\n}\n\nconst mapStateToProps = ({ calls }) => ({\n  modalOpen: calls.modalOpen,\n})\n\nexport default connect(mapStateToProps, { getUsers, getTwilioConfig })(App);\n","import { DEFAULT_LIMIT } from '../../constants';\nimport {\n  GET_USERS,\n  GET_USERS_SUCCESS,\n  GET_USERS_ERROR,\n  UPDATE_ME,\n} from '../actions';\n\nconst INIT_STATE = {\n  users: [],\n  isLoading: false,\n  me: null,\n  pagination: {\n    limit: DEFAULT_LIMIT,\n    offset: 0,\n    totalCount: null,\n  }\n};\n\nexport default (state = INIT_STATE, { type, payload }) => {\n  switch (type) {\n    case GET_USERS:\n      return { ...state, isLoading: true, };\n    case GET_USERS_SUCCESS:\n      return { ...state, isLoading: false, ...payload };\n    case GET_USERS_ERROR:\n      return { ...state, isLoading: false, users: [] };\n    case UPDATE_ME:\n      return { ...state, me: payload };\n    default: return { ...state };\n  }\n}\n","import { CallStatuses } from '../../constants/callStatuses';\nimport { CALL_MODAL_STATUS, GET_TWILLIO_CONFIG, GET_TWILLIO_CONFIG_FAIL, GET_TWILLIO_CONFIG_SUCCESS, SET_CALL } from '../actions';\n\nconst INIT_STATE = {\n  modalOpen: false,\n  call: {\n    id: null,\n    callerId: null,\n    calleeId: null,\n    status: CallStatuses.PENDING,\n  },\n  config: []\n};\n\nexport default (state = INIT_STATE, { type, payload }) => {\n  switch (type) {\n    case CALL_MODAL_STATUS:\n      return { ...state, modalOpen: payload, };\n    case SET_CALL:\n      return { ...state, call: payload, };\n    case GET_TWILLIO_CONFIG:\n      return { ...state };\n    case GET_TWILLIO_CONFIG_SUCCESS:\n      return { ...state, config: payload };\n    case GET_TWILLIO_CONFIG_FAIL:\n      return { ...state, config: [] };\n    default: return { ...state };\n  }\n}\n","import { combineReducers } from 'redux';\n\nimport users from './users/reducer';\nimport calls from './calls/reducer';\n\nconst reducers = combineReducers({\n  users,\n  calls,\n});\n\nexport default reducers;\n","import { DEFAULT_LIMIT } from \"../constants\";\n\nexport const updatePaginationState = ({ nextOffset, totalCount, limit = DEFAULT_LIMIT }, ) => ({\n  totalCount,\n  limit,\n  offset: nextOffset,\n})\n","import { all, call, fork, put, takeEvery, select } from \"redux-saga/effects\";\n\nimport { getUsersError, getUsersSuccess } from \"./actions\";\nimport { GET_USERS } from \"../actions\";\nimport { getUserList } from \"../../api\";\nimport { updatePaginationState } from \"../../helpers/pagination\";\n\nexport function* watchGetUsers() {\n  yield takeEvery(GET_USERS, getUsers);\n}\n\nconst getUsersAsync = (params) => async () => {\n  return getUserList(params);\n};\n\nfunction* getUsers() {\n  const { offset, users } = yield select(state => state.users);\n\n  try {\n    const { data, pagination } = yield call(getUsersAsync({ offset }));\n    yield put(getUsersSuccess({\n      pagination: updatePaginationState(pagination),\n      users: [...users, ...data],\n    }));\n  } catch (error) {\n    yield put(getUsersError());\n  }\n}\n\n\nexport default function* rootSaga() {\n  yield all([\n    fork(watchGetUsers),\n  ]);\n}\n","export const immutableSplice = (list, index) => [...list.slice(0, index), ...list.slice(index + 1)];\nexport const immutableUpdateByIndex = (list, index, value) => [...list.slice(0, index), value, ...list.slice(index + 1)];\nexport const immutableInsertByIndex = (list, oldIndex, newIndex, value) => {\n  const withoutElement = immutableSplice(list, oldIndex);\n\n  return [...withoutElement.slice(0, newIndex), value, ...withoutElement.slice(newIndex)];\n}\n","import { createBrowserHistory } from 'history';\n\n/**\n * @type {history} History used internally by BrowserRouter\n */\nexport default createBrowserHistory();\n","import { all, call, fork, put, select, take } from \"redux-saga/effects\";\nimport { toast } from 'react-toastify';\n\nimport { getUsersSuccess, updateMe } from \"../users/actions\";\nimport { createUsersChannel } from \"../../api/socket\";\nimport { SocketEvents } from '../../constants/socketEvents';\nimport { immutableSplice, immutableUpdateByIndex } from '../../helpers/immutable';\nimport { setCall, setModal } from '../calls/actions';\nimport { CallStatuses } from '../../constants/callStatuses';\nimport { toastConfig } from '../../constants/toastConfig';\nimport { setToUserStorage } from '../../helpers/storage';\nimport reactHistory from '../../helpers/history';\n\nexport function* watchSocketsChannel() {\n  const channel = yield call(createUsersChannel);\n\n  while (true) {\n    const { event, data } = yield take(channel);\n    const me = yield (select(state => state.users.me));\n    let users;\n\n    switch (event) {\n      case SocketEvents.CUSTOM_ERROR:\n        toast.error(data, toastConfig);\n        break;\n      case SocketEvents.MY_DATA:\n        setToUserStorage(data.name);\n        yield put(updateMe(data));\n        break;\n      case SocketEvents.REQUESTED_CALL:\n        yield put(setCall(data));\n        if (me.id !== data.caller.id) {\n          yield put(setModal(true));\n        }\n        break;\n      case SocketEvents.DECLINED_CALL:\n        const declinedCall = yield (select(state => state.calls.call));\n        yield put(setCall({ ...declinedCall, status: CallStatuses.CANCELED }));\n        yield put(setModal(false));\n\n        reactHistory.replace('/')\n\n        toast.error('Call has been canceled by other user.', toastConfig);\n        break;\n      case SocketEvents.ACCEPTED_CALL:\n        const ongoingCall = yield (select(state => state.calls.call));\n\n        yield put(setCall({ ...ongoingCall, status: CallStatuses.APPROVED }));\n        yield put(setModal(false));\n\n        reactHistory.push('/call')\n        break;\n      case SocketEvents.USER_JOINED:\n        users = yield (select(state => state.users.users));\n        yield put(getUsersSuccess({ users: [data, ...users] }));\n        break;\n      case SocketEvents.USER_UPDATED:\n        if (data.id !== me.id) {\n          users = yield (select(state => state.users.users));\n\n          yield put(getUsersSuccess({\n            users: immutableUpdateByIndex(\n              users,\n              users.findIndex(({ id }) => id === data.id),\n              data,\n            )\n          }));\n          ;\n        }\n        break;\n      case SocketEvents.USER_LEFT:\n        users = yield (select(state => state.users.users));\n        yield put(getUsersSuccess({ users: immutableSplice(users, users.findIndex(({ id }) => id === data)) }));\n        break;\n      default:\n        break;\n    }\n  }\n}\n\nexport default function* rootSaga() {\n  yield all([\n    fork(watchSocketsChannel),\n  ]);\n}\n","import { all, call, fork, put, takeLatest } from \"redux-saga/effects\";\n\nimport { getTwilioConfigFail, getTwilioConfigSuccess } from \"./actions\";\nimport { GET_TWILLIO_CONFIG } from \"../actions\";\nimport { getTwilioConfig } from \"../../api\";\n\nexport function* watchGetTwilioConfig() {\n  yield takeLatest(GET_TWILLIO_CONFIG, getConfig);\n}\n\nfunction* getConfig() {\n  try {\n    const servers = yield call(getTwilioConfig);\n\n    yield put(getTwilioConfigSuccess(servers));\n  } catch (error) {\n    yield put(getTwilioConfigFail());\n  }\n}\n\n\nexport default function* rootSaga() {\n  yield all([\n    fork(watchGetTwilioConfig),\n  ]);\n}\n","import { all } from 'redux-saga/effects';\n\nimport usersSagas from './users/saga';\nimport socketsSagas from './sockets/saga';\nimport callsSagas from './calls/saga';\n\nexport default function* rootSaga(getState) {\n  yield all([\n    usersSagas(),\n    callsSagas(),\n    socketsSagas(),\n  ]);\n}\n","import { createStore, applyMiddleware, compose } from 'redux';\nimport createSagaMiddleware from \"redux-saga\";\n\nimport reducers from './reducers';\nimport sagas from \"./sagas\";\n\nconst sagaMiddleware = createSagaMiddleware();\n\nconst middlewares = [sagaMiddleware];\n\nexport function configureStore(initialState) {\n  let enhancedCompose = compose;\n\n  if (window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__ && process.env.NODE_ENV !== 'production') {\n    enhancedCompose = window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__({});\n  }\n\n\n  const store = createStore(\n    reducers,\n    initialState,\n    enhancedCompose(applyMiddleware(...middlewares))\n  );\n\n  sagaMiddleware.run(sagas);\n\n  if (module.hot) {\n    module.hot.accept('./reducers', () => {\n      const nextRootReducer = require('./reducers');\n      store.replaceReducer(nextRootReducer);\n    });\n  }\n\n  return store;\n}\n\nexport default configureStore();\n","import React, { Suspense } from 'react';\nimport ReactDOM from 'react-dom';\nimport { Router } from 'react-router-dom';\nimport { Provider } from 'react-redux';\nimport { ToastContainer } from 'react-toastify';\n\nimport App from './App';\nimport store from './redux/store';\nimport routerHistory from './helpers/history';\n\nimport 'react-toastify/dist/ReactToastify.css';\nimport './assets/styles/index.scss';\n\nReactDOM.render(\n  <Provider store={store}>\n    <Suspense fallback={<div className=\"loading\" />}>\n      <ToastContainer />\n      <Router history={routerHistory}>\n        <App />\n      </Router>\n    </Suspense>\n  </Provider>,\n  document.getElementById('root')\n);\n"],"sourceRoot":""}